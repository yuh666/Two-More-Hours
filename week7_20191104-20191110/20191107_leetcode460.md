```java
class LFUCache {

    private Node[] container;
    private int size;
    private int capacity;
    private Map<Integer, Integer> indexMap;
    int count = 0;

    public LFUCache(int capacity) {
        this.container = new Node[capacity + 1];
        this.capacity = capacity;
        this.size = 0;
        this.indexMap = new HashMap<>(capacity * 2);
    }

    public int get(int key) {
        Integer index = indexMap.get(key);
        if (index == null) {
            return -1;
        }
        int val = container[index].value;
        container[index].useCount++;
        container[index].timestamp = count++;
        heapify();

        return val;
    }

    public void put(int key, int value) {
        if (capacity == 0) {
            return;
        }
        Integer keyIndex = indexMap.get(key);

        if (keyIndex != null) {
            container[keyIndex].value = value;
            container[keyIndex].useCount++;
            heapify();
            return;
        }

        if (size >= capacity) {
            indexMap.remove(container[1].key);
            container[1] = container[size--];
            shiftDown(1);
        }

        container[++size] = new Node(key, value, 0, count++);
        indexMap.put(key, size);
        shiftUp(size);
    }

    /**
     * @param index shiftUp之前的位置
     * @return shiftUp之后的位置
     */
    private int shiftUp(int index) {
        while (index > 1 && index <= size) {
            Node parent = container[index / 2];
            if ((parent.useCount < container[index].useCount) ||
                    (parent.useCount == container[index].useCount && parent.timestamp < container[index].timestamp)) {
                break;
            }
            int parentIndex = index / 2;
            change(parentIndex, index);
            index = parentIndex;
        }
        return index;
    }

    /**
     * @param index shiftDown之前的位置
     * @return shiftDown之后的位置
     */
    private int shiftDown(int index) {
        while (index <= size / 2) {
            int sonIndex = minUseCountIndex(index * 2, index * 2 + 1);

            if ((container[sonIndex].useCount > container[index].useCount) ||
                    (container[sonIndex].useCount == container[index].useCount && container[sonIndex].timestamp > container[index].timestamp)) {
                break;
            }

            change(sonIndex, index);
            index = sonIndex;
        }
        return index;
    }

    private int minUseCountIndex(int aIndex, int bIndex) {
        if (aIndex <= size && bIndex <= size) {
            Node aNode = container[aIndex];
            Node bNode = container[bIndex];
            if (aNode.useCount == bNode.useCount) {
                return aNode.timestamp < bNode.timestamp ? aIndex : bIndex;
            }
            return aNode.useCount < bNode.useCount ? aIndex : bIndex;
        }
        return aIndex <= size ? aIndex : bIndex;
    }

    private void change(int aIndex, int bIndex) {
        Node temp = container[aIndex];
        container[aIndex] = container[bIndex];
        container[bIndex] = temp;

        indexMap.put(container[aIndex].key, aIndex);
        indexMap.put(container[bIndex].key, bIndex);
    }

    private class Node {
        int key;
        int value;
        int useCount;
        long timestamp;

        private Node(int key, int value, int useCount, long timestamp) {
            this.key = key;
            this.value = value;
            this.useCount = useCount;
            this.timestamp = timestamp;
        }
    }

    private void heapify() {
        for (int i = size / 2; i > 0; i--) {
            shiftDown(i);
        }
    }
}

/**
 * Your LFUCache object will be instantiated and called as such:
 * LFUCache obj = new LFUCache(capacity);
 * int param_1 = obj.get(key);
 * obj.put(key,value);
 */
```