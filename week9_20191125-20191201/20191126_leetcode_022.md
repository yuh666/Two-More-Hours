    
# 问题描述:
   - 括号生成:https://leetcode-cn.com/problems/generate-parentheses
    
# 思路:    
    public class Question022 {

    /**
     * 回溯问题:
     * 1.每一个元素有两种选择,由于有效括号则第一个元素为 ( 最后一个元素为)
     * <p>
     * 2.left:0 right:0
     * 3.选择(  left:2
     */
    class Solution {

        private List<String> result = new ArrayList<>();

        private String left = "(";

        private String right = ")";

        private Integer length;

        private Integer leftTotal;

        private Integer rightTotal;

        public List<String> generateParenthesis(int n) {
            Stack<String> stack = new Stack<>();
            length = n;
            stack.add(left);
            leftTotal = 1;
            rightTotal = 0;
            back(1, 2 * n, stack);
            return result;
        }

        private void back(int row, int n, Stack<String> stack) {
            if (row == n) {
                List<String> list = new ArrayList<>(stack);
                StringBuilder builder = new StringBuilder();
                for (String s : list) {
                    builder.append(s);
                }
                String str = builder.toString();
                result.add(str);
                return;
            }


            // 每一行有两种情况
            for (int i = 0; i < 2; i++) {
                String current = i == 0 ? left : right;
                if (isOk(current)) {
                    stack.add(current);
                    back(row + 1, n, stack);
                    if (Objects.equals(stack.peek(), left)) {
                        leftTotal--;
                    } else {
                        rightTotal--;
                    }
                    stack.pop();
                }
            }
        }

        /**
         * 判断一下是否完成
         *
         * @param current
         * @return
         */
        private boolean isOk(String current) {
            // 当左边括号或者右边括号大于长度时
            if (leftTotal == length && Objects.equals(current, left)) {
                return false;
            }

            if (rightTotal == length && Objects.equals(current, right)) {
                return false;
            }
            // 当左边括号个数等于右括号
            if (leftTotal == rightTotal && !Objects.equals(current, left)) {
                return false;
            }

            // 前后字段不相等
            if (Objects.equals(current, left)) {
                leftTotal++;
            } else {
                rightTotal++;
            }
            return true;
        }
    }

    /**
     * 回溯2:代码优化
     */
    class Solution2 {


        private List<String> list = new ArrayList<>();

        public List<String> generateParenthesis(int n) {
            back(0, 0, "", n);
            return list;
        }

        private void back(int left, int right, String current, int n) {
            if (current.length() == 2 * n) {
                list.add(current);
                return;
            }

            // 当左括号小于max时 选择left
            if (left < n) {
                back(left + 1, right, current + "(", n);
            }

            // 当右括号小于左括号是 选择 right
            if (right < left) {
                back(left, right + 1, current + ")", n);
            }
        }

    }

    @Test
    public void test1() {
        Solution2 solution = new Solution2();
        System.out.println(solution.generateParenthesis(4));
    }
    }
