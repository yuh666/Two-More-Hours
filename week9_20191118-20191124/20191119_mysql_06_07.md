**全局锁**

- 使用场景
  - 全库备份
    - Flush tables with read lock; # 全局加读锁
    - mysqldump single-transaction; # 官方自带逻辑备份工具
  - 主备设计
    - set global readonly = 1; # 备库

**表级锁**

- 表锁
  - lock tables T read/write;
  - unlock tables;
- MDL（metadata lock）
  - MDL读锁：对数据的增删改查
  - MDL写锁：对表结构的变更操作
- 最佳实践
  - 修改表结构
    - NOWAIT
    - WAIT N

**行级锁**

- 两阶段锁：在 InnoDB 事务中，行锁是在需要的时候才加上的，但并不是不需要了就立刻释放，而是要等到事务结束时才释放。这个就是两阶段锁协议。
- 死锁
- 死锁处理
  - 超时策略：innodb_lock_wait_timeout（设置死锁超时时间）
  - 检查策略：innodb_deadlock_detect（设置是否开启死锁检查）

