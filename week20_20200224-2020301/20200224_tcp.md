## TCP三次握手

1. 第一次握手:客户端请求服务端建立连接
2. 第二次握手:服务端响应客户端建立连接完成
3. 第三次握手:客户端给服务端发送确认,这时候服务端才和客户端建立完连接
4. 问题:为啥是三次握手不是一次,二次,四次
   - 一次握手:客户端请求服务端建立连接,客户端不知道服务端是否能建立连接
   - 二次握手:当客户端第一次握手由于网络问题卡顿之后,没收到服务端的响应;重新发送一次第一次握手此时服务端收到响应连接建立完成;之后网络正常服务端又收到了一次握手,又需要开辟新的资源来处理客户端连接,但是这次连接时一直没有数据发送过来的;所以需要第三次握手,当客户端接收到服务端响应后,客户端发送这个连接之前发送过,此时客户端发送第三次握手让服务端来关闭重复开辟的资源
   - 四次握手:三次握手已经够用不需要再次握手比如买东西,3块钱就可以买到为啥还要花4块钱



## TCP四次挥手

1. 第一次挥手:客户端发出连接释放的报文,并停止发送数据
2. 第二次挥手:服务端收到连接释放确认报文,服务端进入关闭等待状态;客户端会接受到报文等待服务端发送连接释放的报文即第三次挥手
3. 第三次挥手:服务端将最后的数据发送完毕给客户端之后,向客户端发送连接释放确认报文
4. 第四次挥手:客户端收到服务器的连接释放确认报文后,给服务端发送确认;服务端收到确认后进入关闭状态
5. 但是客户端会等待2*MSL(最长报文段寿命)后进入关闭状态
   - 为了防止第四次挥手超时,可以重发 
   - 防止客户端在服务端确认关闭连接后在去连接上服务端保证连接能正常的关闭