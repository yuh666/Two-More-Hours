## https执行流程

![image-20200225144828818](https://note.youdao.com/yws/public/resource/0913f7b1edd0a739cddfc0fb16cfac5b/xmlnote/F12CF5A5D6964C50B8A5281E882DC6F6/9193)

1. 浏览器请求服务器获取证书信息
2. 服务器返回证书信息给浏览器,包括证书公钥(非对称加密)+hash算法(数据篡改校验)+加密算法(对称加密,秘钥为随机密码)
3. 浏览器判断证书是否合法,给出提示,合法是浏览器上有一个锁可以通过锁查看证书信息,不合法下可能是中间人
4. 浏览器生成一个随机数,发送数据给服务器包括以下三部分
   - 加密后的随机数:通过公钥对生成随机数加密
   - 消息hash算法后的值:对浏览器发送给服务器的消息进行hash算法,防止消息被篡改
   - 对称加密后的消息内容:通过随机密码作为秘钥+对称加密的算法对消息内容进行加密
5. 服务器接收客户端发送过来的内容,进行解密和校验操作
   - 通过私钥对加密后的随机密码解密获取随机密码
   - 通过随机密码和对称加密算法获取消息内容
   - 将消息内容通过hash算法计算后判断消息内容是否被篡改
6. 服务器传输对称加密后的内容给浏览器,浏览器通过本地的随机密码解密获取内容,以后浏览器和服务器这样传输数据